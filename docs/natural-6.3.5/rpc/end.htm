
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   
      <meta name="generator" content="Sagdoc XSL Stylesheets">
      <link rel="stylesheet" type="text/css" href="../general/style2.css"><script type="text/javascript" language="javascript">
         <!--
window.name = 'contents';
//--></script><title>Terminating a Natural RPC Server</title>
   </head>
   <body bgcolor="#FFFFFF" background="../graphics/bar.png" style="margin-left: 20px;">
      <div><a name="end"></a></div>
      <div class="noprint">
         <div class="nospytext">
            <table border="0" cellpadding="0" cellspacing="0" width="97%">
               <col width="15%">
               <col width="34%">
               <col width="48%">
               <tr>
                  <td colspan="2" class="topline"><a name="Top"></a>&nbsp;<img src="../graphics/natux_logo.png"></td>
                  <td class="topline" align="right"><img src="../graphics/sag_logo.png">&nbsp;
                  </td>
               </tr>
               <tr>
                  <td class="header" nowrap><img src="../graphics/blank.png" width="3" height="10"></td>
                  <td class="header"><img src="../graphics/blank.png" width="3">Version&nbsp;6.3.5 for UNIX
                  </td>
                  <td class="toplinks" align="right" nowrap><img src="../graphics/blank.png" width="3"><a class="navig" target="_blank" href="../fts/search.htm" onclick="window.open('../fts/search.htm', 'fts', 'dependent,width=555,height=420,resizable'); return false">SEARCH</a>
                     &nbsp;&nbsp;<a class="navig" href="javascript:sized_window('../navig/navig.htm')" onclick="document.cookie='sagphdcc=../rpc/end.htm;path=/'; window.open('../navig/navig.htm', 'nvgtr', 'dependent,width=450,height=270,resizable'); return false">CONTENTS</a>&nbsp;&nbsp;&nbsp;|
                     &nbsp;&nbsp;<a class="navig" target="_blank" href="http://documentation.softwareag.com/natural/nat635unx/pdf/rpc/end.pdf">PDF PAGE</a>
                     &nbsp;&nbsp;<a class="navig" target="_blank" href="../general/print.htm">PDF BOOKS</a>&nbsp;&nbsp;&nbsp;|
                     &nbsp;&nbsp;<a class="navig" href="../overview.htm">HOME</a>
                     &nbsp;&nbsp;<a class="navig" href="rpc-over.htm">UP</a>
                     &nbsp;&nbsp;<a class="navig" href="start.htm">PREV</a>
                     &nbsp;&nbsp;<a class="navig" href="terminate_exx_broker_service.htm">NEXT</a></td>
               </tr>
            </table>
         </div>
      </div>
      <div class="nospytext" style="margin-top:0.25in;">
         <div><span class="module">&nbsp;&#8212;&nbsp;&nbsp;Natural Remote Procedure Call (RPC)&nbsp;&nbsp;&#8212;</span></div>
      </div> 
        
      <div class="nospytext">
         <h1>Terminating a Natural RPC Server</h1>
      </div> 
         
      <p>This section describes how to terminate a Natural RPC server. Several
             methods exist.
      </p> 
      <ul>
         <li>
            <p class="initem"><a href="end.htm#end_terminate_via_sysrpc">Using SYSRPC</a></p>
         </li>
         <li>
            <p class="initem"><a href="end.htm#end_terminate_via_entirex_smh">Using EntireX System Management Hub</a></p>
         </li>
         <li>
            <p class="initem"><a href="end.htm#end_using_usr2073n">Using Application Programming Interface USR2073N</a></p>
         </li>
         <li>
            <p class="initem"><a href="end.htm#end_natrpc99">User Exit NATRPC99</a></p>
         </li>
         <li>
            <p class="initem"><a href="end.htm#attach_manager_srvterm">Server Termination When Using an Attach Manager</a></p>
         </li>
      </ul>
      <hr>
      <div><a name="end_terminate_via_sysrpc"></a></div> 
         
      <h2>Using SYSRPC</h2> 
          
          
      <p>Use the <code>TE</code> (Terminate
              Server) command of the <code>SYSRPC</code> utility as
              described in <a href="../utis/sysrpc_com_exec.htm#sysrpc_com_exec_Terminating_a_Server">Terminating
            a Server</a> in the <cite>SYSRPC
                 Utility</cite> documentation.
      </p> 
          
      <p>A Natural RPC server can only be terminated if the server is currently
              neither executing a remote <code>CALLNAT</code> nor waiting for the next
              <code>CALLNAT</code> request in a conversation.
      </p> 
         
      <div class="noprint">
         <p><a href="end.htm#Top"><img src="../graphics/uparrow.png" alt="Top of page" height="17" width="17" border="0"></a></p>
      </div>
      <div><a name="end_terminate_via_entirex_smh"></a></div> 
         
      <h2>Using EntireX System Management Hub</h2> 
          
          
      <p>Use the <span class="guibutton">Deregister</span> button in the Server subtree
              of the EntireX System Management Hub.
      </p> 
         
      <div class="noprint">
         <p><a href="end.htm#Top"><img src="../graphics/uparrow.png" alt="Top of page" height="17" width="17" border="0"></a></p>
      </div>
      <div><a name="end_using_usr2073n"></a></div> 
         
      <h2>Using Application Programming Interface USR2073N</h2> 
          
          
      <p><strong></strong>The Application Programming Interface (API)
              <code>USR2073N</code> enables you to ping or terminate a Natural RPC
              server.
      </p> 
          
      <p>The interface sends a ping or terminate command to an RPC server
              specified by node name and server name. The returned message contains the
              following information:
      </p> 
          
      <ul> 
              
         <li> 
                  
            <p class="initem">the version of the running server (<code>PING</code>) or
            </p> 
                 
         </li> 
              
         <li> 
                  
            <p class="initem">the acknowledgment of termination (<code>TERMINATE</code>) or
            </p> 
                 
         </li> 
              
         <li> 
                  
            <p class="initem">an error message.</p> 
                 
         </li> 
             
      </ul> 
          
      <p class="to"><img src="../graphics/bluearro.png" alt="Start of instruction set" width="18" height="15"><strong>To make use of <code>USR2073N</code></strong></p>
      <ol class="steps">
         <li> 
                   
                   
            <p class="instep">Copy the subprogram <code>USR2073N</code> from libray
                       <code>SYSEXT</code> to the library <code>SYSTEM</code> or to the steplib
                       library or to any application in the server environment.
            </p> 
                   
                 
         </li>
         <li> 
                   
                   
            <p class="instep">Using a <a href="../sm/defineda_parms.htm"><code>DEFINE DATA
                     PARAMETER</code></a> statement in structured mode or a
                       <code>RESET</code> statement in reporting mode, specify the following
                       parameters: 
            </p> 
                    
                    
            <table border="1" class="color" cellpadding="3" width="97%"> 
                        
               <thead align="left" valign="top"> 
                            
                  <tr> 
                                
                     <th align="left">Parameter</th> 
                                
                     <th>Format</th> 
                                
                     <th>I/O</th> 
                                
                     <th colspan="2">Description</th> 
                               
                  </tr> 
                           
               </thead> 
                        
               <tbody align="left" valign="top"> 
                            
                  <tr> 
                                
                     <td rowspan="2" align="left" nowrap><code>FUNCTION</code></td> 
                                
                     <td rowspan="2">A10</td> 
                                
                     <td rowspan="2">I</td> 
                                
                     <td><code>PING</code></td> 
                                
                     <td>Asks the RPC server for its version.</td> 
                               
                  </tr> 
                            
                  <tr> 
                                
                     <td><code>TERMINATE</code></td> 
                                
                     <td>Initiates the finishing of the Natural RPC server
                        task.
                     </td> 
                               
                  </tr> 
                            
                  <tr> 
                                
                     <td align="left"><code>SRVNODE</code></td> 
                                
                     <td>A192</td> 
                                
                     <td>I</td> 
                                
                     <td colspan="2">Specify the node name or * if
                        the server name represents a Location Transparency of EntireX or a logical
                        broker node name as
                        <code>LOGBROKER=<var>nodename</var></code>). See the
                                    profile parameter  <a href="../parms/srvnode.htm"><code>SRVNODE</code></a>
                                    .
                     </td>
                                
                               
                  </tr> 
                            
                  <tr> 
                                
                     <td align="left"><code>SRVNAME</code></td> 
                                
                     <td>A192</td> 
                                
                     <td>I</td> 
                                
                     <td colspan="2">Server name or EntireX Location
                        Transparency. See the profile parameter
                        
                        <a href="../parms/srvname.htm"><code>SRVNAME</code></a>
                                    .
                     </td>
                                
                               
                  </tr> 
                            
                  <tr> 
                                
                     <td align="left"><code>LOGON</code></td> 
                                
                     <td>A1</td> 
                                
                     <td>I</td> 
                                
                     <td colspan="2"> 
                        
                        <p>The logon flag <code>Y</code> (yes) indicates that logon data
                           must be transmitted to the Natural RPC server.
                        </p> 
                     </td> 
                               
                  </tr> 
                            
                  <tr> 
                                
                     <td align="left"><code>USER-ID</code></td> 
                                
                     <td rowspan="2">A8</td> 
                                
                     <td rowspan="2">I</td> 
                                
                     <td rowspan="2" colspan="2"> 
                        
                        <p>If <code>LOGON=Y</code>, then user ID and password are the logon
                           data for Natural Security.
                        </p> 
                                    
                        <p>If the client does not run under Natural Security (NSC) and the
                           logon flag is set, the user ID and password have to be specified unless the
                                        data have been entered via Application Programming Interface
                                        <a href="securi.htm#securi_USR1071"><code>USR1071N</code></a>. See
                                        <cite>Using Security</cite>,
                                        <a href="securi.htm#securi_Using_Natural_RPC_with_Natural_Security">Using
                                           Natural RPC with Natural Security</a>.
                        </p> 
                     </td> 
                               
                  </tr> 
                            
                  <tr> 
                                
                     <td align="left"><code>PASSWORD</code></td> 
                               
                  </tr> 
                            
                  <tr> 
                                
                     <td align="left"><code>MSG</code></td> 
                                
                     <td>A79</td> 
                                
                     <td>O</td> 
                                
                     <td colspan="2">Message returned.</td> 
                               
                  </tr> 
                            
                  <tr> 
                                
                     <td rowspan="5" align="left"><code>RC</code></td> 
                                
                     <td rowspan="5">I2</td> 
                                
                     <td rowspan="5">O</td> 
                                
                     <td colspan="2">Response code; possible values
                        are:
                     </td> 
                               
                  </tr> 
                            
                  <tr> 
                                
                     <td><code>0</code></td> 
                                
                     <td><code>MSG</code> contains a normal message from RPC
                        server or Broker.
                     </td> 
                               
                  </tr> 
                            
                  <tr> 
                                
                     <td><code>1</code></td> 
                                
                     <td><code>MSG</code> contains an error message from RPC
                        server or Broker.
                     </td> 
                               
                  </tr> 
                            
                  <tr> 
                                
                     <td><code>2</code></td> 
                                
                     <td><code>MSG</code> contains an error message from the
                        interface.
                     </td> 
                               
                  </tr> 
                            
                  <tr> 
                                
                     <td><code>3</code></td> 
                                
                     <td>Natural Security error.</td> 
                               
                  </tr> 
                           
               </tbody> 
                       
            </table> 
                    
                   
                 
         </li>
         <li> 
                   
                   
            <p class="instep">Before invoking the API, fill the input variables listed above.</p> 
                   
                 
         </li>
      </ol> 
         
      <div class="noprint">
         <p><a href="end.htm#Top"><img src="../graphics/uparrow.png" alt="Top of page" height="17" width="17" border="0"></a></p>
      </div>
      <div><a name="end_natrpc99"></a></div> 
         
      <h2>User Exit NATRPC99</h2> 
          
          
      <p>This exit is called after the Natural RPC server has deregistered and
              logged off from the server node.
      </p> 
          
      <ul> 
              
         <li> 
                  
            <p class="initem">If no <code>NATRPC99</code> program is found, the server terminates
                      immediately as usual.
            </p> 
                 
         </li> 
              
         <li> 
                  
            <p class="initem">If the program <code>NATRPC99</code> is found, the server continues to
                      run as a normal Natural session.
            </p> 
                 
         </li> 
             
      </ul> 
          
      <p><code>NATRPC99</code> is called with a <a href="../sm/fetch.htm"><code>FETCH</code></a> statement without any
              parameters, that is, no data is put on the Natural stack before
              <code>NATRPC99</code> has been called.
      </p> 
          
      <p>You may add any coding to <code>NATRPC99</code>, including transfer
              control statements (<a href="../sm/fetch.htm"><code>FETCH</code></a>,
              <a href="../sm/callnat.htm"><code>CALLNAT</code></a>,
              <a href="../sm/perform.htm"><code>PERFORM</code></a>) and
              statements that terminate the program (<a href="../sm/stop.htm"><code>STOP</code></a>,
              <a href="../sm/escape.htm"><code>ESCAPE</code></a>,
              <a href="../sm/terminat.htm"><code>TERMINATE</code></a>).
      </p> 
          
      <p>If <code>NATRPC99</code> is terminated with a <code>RETURN</code> or
              <code>STOP</code> statement, Natural returns to the <code>NEXT</code> prompt.
              If the <code>NEXT</code> prompt is not supported in the environment used
              (profile paramter <a href="../parms/cm.htm"><code>CM</code></a><code>=OFF</code>, asynchronous
              Natural session, etc.) the session terminates. Otherwise, the session tries to
              read the next command from the primary input file/dataset for Natural commands
              and <code>INPUT</code> data (<code>CMSYNIN</code>).
      </p>
          
          
      <h4 class="floating-title">Important Notes:</h4> 
          
      <ol> 
              
         <li> 
                  
            <p class="initem"><code>NATRPC99</code> must be a Natural program.
            </p> 
                 
         </li> 
              
         <li> 
                  
            <p class="initem"><code>NATRPC99</code> must be located in the library
                      <code>SYSTEM</code> on system file <code>FUSER</code>. The steplib
                      concatenation of the library to which the server currently is logged on is not
                      evaluated to find <code>NATRPC99</code>.
            </p> 
                 
         </li> 
              
         <li> 
                  
            <p class="initem"><code>NATRPC99</code> is currently only called if the server is
                      terminated with a <code>TE</code>
                      (Terminate Server)  command issued using
                      the <code>SYSRPC</code> utility as described in <a href="../utis/sysrpc_com_exec.htm#sysrpc_com_exec_Terminating_a_Server">Terminating
                  a Server</a> in the <cite>SYSRPC
                         Utility</cite> documentation. The exit is not called if the server is
                      terminated via the <a href="end.htm#end_terminate_via_entirex_smh">EntireX
                         System Management Hub</a>.
            </p> 
                 
         </li> 
              
         <li> 
                  
            <p class="initem">Natural objects that are called by <code>NATRPC99</code> (<a href="../sm/fetch.htm"><code>FETCH</code></a>,
                      <a href="../sm/callnat.htm"><code>CALLNAT</code></a>,
                      <a href="../sm/perform.htm"><code>PERFORM</code></a>) must be
                      located either in the library to which the server is logged on or in one of its
                      steplibs (including <code>SYSTEM</code> on system file <code>FUSER</code>).
            </p>
                  
                 
         </li> 
             
      </ol> 
         
      <div class="noprint">
         <p><a href="end.htm#Top"><img src="../graphics/uparrow.png" alt="Top of page" height="17" width="17" border="0"></a></p>
      </div>
      <div><a name="attach_manager_srvterm"></a></div> 
         
      <h2>Server Termination When Using an Attach Manager</h2> 
          
          
      <p>The profile parameter <a href="../parms/srvterm.htm"><code>SRVTERM</code></a> influences the termination behavior of a Natural RPC server. By
              default, a server is never terminated (<code>SRVTERM=NEVER</code>) unless one
              of the termination methods described before is applied. 
      </p> 
          
      <p>If you use an Attach Manager to dynamically start Natural RPC servers on
              request, you should set <code>SRVTERM</code> to <code>TIMEOUT</code>.
              With this parameter setting, a Natural RPC server is automatically terminated
              if the wait time for the next client request outside of an RPC conversation is
              exceeded.
      </p> 
         
      <div class="noprint">
         <div class="nospy">
            <p><a href="end.htm#Top"><img src="../graphics/uparrow.png" alt="Top of page" height="17" width="17" border="0"></a></p>
            <table border="0" cellpadding="0" cellspacing="0" width="97%">
               <col width="15%">
               <col width="34%">
               <col width="48%">
               <tr>
                  <td class="footer"><img src="../graphics/blank.png" width="3" height="10">&nbsp;<a class="navig" target="_blank" href="http://www.softwareag.com">www.softwareag.com</a>&nbsp;
                  </td>
                  <td nowrap class="footer"><img src="../graphics/blank.png" width="3"><a class="navig" href="../general/legal.htm" target="_blank">Copyright &copy; Software AG 1992-2008. All rights reserved.&nbsp;</a></td>
                  <td class="bottomlinks" align="right" nowrap><img src="../graphics/blank.png" width="3"><a class="navig" target="_blank" href="../fts/search.htm" onclick="window.open('../fts/search.htm', 'fts', 'dependent,width=555,height=420,resizable'); return false">SEARCH</a>
                     &nbsp;&nbsp;<a class="navig" href="javascript:sized_window('../navig/navig.htm')" onclick="document.cookie='sagphdcc=../rpc/end.htm;path=/'; window.open('../navig/navig.htm', 'nvgtr', 'dependent,width=450,height=270,resizable'); return false">CONTENTS</a>&nbsp;&nbsp;&nbsp;|
                     &nbsp;&nbsp;<a class="navig" target="_blank" href="http://documentation.softwareag.com/natural/nat635unx/pdf/rpc/end.pdf">PDF PAGE</a>
                     &nbsp;&nbsp;<a class="navig" target="_blank" href="../general/print.htm">PDF BOOKS</a>&nbsp;&nbsp;&nbsp;|
                     &nbsp;&nbsp;<a class="navig" href="../overview.htm">HOME</a>
                     &nbsp;&nbsp;<a class="navig" href="rpc-over.htm">UP</a>
                     &nbsp;&nbsp;<a class="navig" href="start.htm">PREV</a>
                     &nbsp;&nbsp;<a class="navig" href="terminate_exx_broker_service.htm">NEXT</a></td>
               </tr>
            </table>
         </div>
      </div>
   </body>
</html>