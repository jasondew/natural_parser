
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   
      <meta name="generator" content="Sagdoc XSL Stylesheets">
      <link rel="stylesheet" type="text/css" href="../general/style2.css"><script type="text/javascript" language="javascript">
         <!--
window.name = 'contents';
//--></script><title>External Subroutines</title>
   </head>
   <body bgcolor="#FFFFFF" background="../graphics/bar.png" style="margin-left: 20px;">
      <div><a name="fs-extsub"></a></div>
      <div class="noprint">
         <div class="nospytext">
            <table border="0" cellpadding="0" cellspacing="0" width="97%">
               <col width="15%">
               <col width="34%">
               <col width="48%">
               <tr>
                  <td colspan="2" class="topline"><a name="Top"></a>&nbsp;<img src="../graphics/natux_logo.png"></td>
                  <td class="topline" align="right"><img src="../graphics/sag_logo.png">&nbsp;
                  </td>
               </tr>
               <tr>
                  <td class="header" nowrap><img src="../graphics/blank.png" width="3" height="10"></td>
                  <td class="header"><img src="../graphics/blank.png" width="3">Version&nbsp;6.3.5 for UNIX
                  </td>
                  <td class="toplinks" align="right" nowrap><img src="../graphics/blank.png" width="3"><a class="navig" target="_blank" href="../fts/search.htm" onclick="window.open('../fts/search.htm', 'fts', 'dependent,width=555,height=420,resizable'); return false">SEARCH</a>
                     &nbsp;&nbsp;<a class="navig" href="javascript:sized_window('../navig/navig.htm')" onclick="document.cookie='sagphdcc=../firststeps/fs-extsub.htm;path=/'; window.open('../navig/navig.htm', 'nvgtr', 'dependent,width=450,height=270,resizable'); return false">CONTENTS</a>&nbsp;&nbsp;&nbsp;|
                     &nbsp;&nbsp;<a class="navig" target="_blank" href="http://documentation.softwareag.com/natural/nat635unx/pdf/firststeps/fs-extsub.pdf">PDF PAGE</a>
                     &nbsp;&nbsp;<a class="navig" target="_blank" href="../general/print.htm">PDF BOOKS</a>&nbsp;&nbsp;&nbsp;|
                     &nbsp;&nbsp;<a class="navig" href="../overview.htm">HOME</a>
                     &nbsp;&nbsp;<a class="navig" href="fs-over.htm">UP</a>
                     &nbsp;&nbsp;<a class="navig" href="fs-gda.htm">PREV</a>
                     &nbsp;&nbsp;<a class="navig" href="fs-subprog.htm">NEXT</a></td>
               </tr>
            </table>
         </div>
      </div>
      <div class="nospytext" style="margin-top:0.25in;">
         <div><span class="module">&nbsp;&#8212;&nbsp;&nbsp;First Steps&nbsp;&nbsp;&#8212;</span></div>
      </div> 
        
      <div class="nospytext">
         <h1> 
               <a name="x37"></a> 
               <a name="x38"></a>External Subroutines
         </h1>
      </div> 
         
      <p>Until now, the subroutine <code>MARK-SPECIAL-EMPLOYEES</code> has been
             defined within the program using a <code>DEFINE SUBROUTINE</code> statement.
             You will now define the subroutine as a separate object external to the
             program. 
      </p> 
         
      <p>When you have completed the exercises below, your sample application will
             consist of the following modules:
      </p> 
         
      <p><img src="graphics/fs-extsub.png" alt="Application structure" width="600" height="250"></p> 
         
      <p>This document contains the following
             exercises:
      </p>
      <ul>
         <li>
            <p class="initem"><a href="fs-extsub.htm#fs-extsub-new">Creating an External Subroutine</a></p>
         </li>
         <li>
            <p class="initem"><a href="fs-extsub.htm#fs-extsub-ref">Referencing the External Subroutine from Your Program</a></p>
         </li>
      </ul>
      <hr>
      <div><a name="fs-extsub-new"></a></div> 
         
      <h2>Creating an External Subroutine</h2> 
          
           
          
      <p> Since the existing code from the program will be reused
              in the external subroutine, you will now save the program under a new name,
              change its type to subroutine and delete all lines that are not required.
      </p> 
          
      <p>The <code>DEFINE SUBROUTINE</code> statement of the external subroutine
              is coded in the same way as the inline subroutine in the program.
      </p> 
          
      <p class="to"><img src="../graphics/bluearro.png" alt="Start of instruction set" width="18" height="15"><strong>To create an external subroutine</strong></p>
      <ol class="steps">
         <li> 
                   
                    
                   
            <p class="instep">Enter the following in the command line of the program
                       editor.
            </p> <pre class="command-input">SA SUBR01</pre> 
                   
                   
                   <p class="instep">The current program is saved with the new name <code>SUBR01</code>.
                       The program is still shown in the editor.
            </p> 
                 
         </li>
         <li> 
                   
                    
                   
            <p class="instep">Load the newly created object into the editor by
                       entering the following command:
            </p> <pre class="command-input">E SUBR01</pre> 
                   <p class="instep">The object type is still program.</p> 
                   
                 
         </li>
         <li> 
                   
                   
            <p class="instep">To change the program into an external subroutine, enter the
                       following command:
            </p> <pre class="command-input">SET TYPE S</pre> 
                   <p class="instep">where "S" denotes subroutine.</p> 
                   
                   
                   
            <p class="instep">The object type which is shown in the screen changes to
                       "Subroutine". 
            </p> 
                 
         </li>
         <li> 
                   
                    
                   
            <p class="instep">Use the line command <code>D</code> to delete all
                       lines except the following:
            </p> 
                   <pre class="verbatim">DEFINE DATA
  GLOBAL USING GDA01
  LOCAL USING LDA01
END-DEFINE
*
DEFINE SUBROUTINE MARK-SPECIAL-EMPLOYEES
  MOVE '*' TO #MARK
END-SUBROUTINE
*
END</pre> 
                   <p class="instep">It is also possible to delete a block of text. To do
                       so, you have to proceed as follows:
            </p> 
                   
            <ol> 
                       
               <li> 
                           
                  <p class="initem">At the beginning of the first line of the block, enter the line
                               command <code>.X</code>.
                  </p> 
                          
               </li> 
                       
               <li> 
                           
                  <p class="initem">At the beginning of the last line of the block, enter the line
                               command <code>.Y</code>.
                  </p> 
                          
               </li> 
                       
               <li> 
                           
                  <p class="initem">Press <span class="key">ENTER</span>.
                  </p> 
                           
                  <p class="initem">The block of lines to be deleted is now marked with
                               ".X" and ".Y". (If you
                               want to remove the marks, you can enter <code>RESET</code> in the
                               command line.)
                  </p> 
                          
               </li> 
                       
               <li> 
                           
                  <p class="initem">To delete the marked block, enter <code>DX-Y</code>
                               in the command line.
                  </p> 
                          
               </li> 
                      
            </ol> 
                   
                 
         </li>
         <li> 
                   
                   
            <p class="instep">Stow the subroutine.</p> 
                   
                 
         </li>
      </ol> 
         
      <div class="noprint">
         <p><a href="fs-extsub.htm#Top"><img src="../graphics/uparrow.png" alt="Top of page" height="17" width="17" border="0"></a></p>
      </div>
      <div><a name="fs-extsub-ref"></a></div> 
         
      <h2>Referencing the External Subroutine from Your Program</h2> 
          
          
      <p>The <code>PERFORM</code> statement invokes both internal and external
              subroutines. When an internal subroutine is not found in the program, Natural
              automatically tries to perform an external subroutine with the same name. Note
              that Natural looks for the name that has been defined in the subroutine code
              (that is: the subroutine name), not for the name that you have specified when
              saving the subroutine (that is: the Natural object name).
      </p> 
          
      <p>Now that you have defined an external subroutine, you have to remove the
              inline subroutine (which has the same name as the external subroutine) from
              your program.
      </p> 
          
      <p class="to"><img src="../graphics/bluearro.png" alt="Start of instruction set" width="18" height="15"><strong>To use the external subroutine in your program</strong></p>
      <ol class="steps">
         <li> 
                   
                   
            <p class="instep">Return to the program editor by entering the
                       following in the command line of the editor in which the subroutine is
                       currently shown.
            </p> <pre class="command-input">E PGM01</pre> 
                   
                 </li>
         <li> 
                   
                   
            <p class="instep">Remove the following lines:</p> 
                   <pre class="verbatim">DEFINE SUBROUTINE MARK-SPECIAL-EMPLOYEES
  MOVE '*' TO #MARK
END-SUBROUTINE</pre> 
                   
                   <p class="instep">Your program should now look as follows:</p> 
                   <pre class="verbatim">DEFINE DATA
  GLOBAL USING GDA01  
  LOCAL USING LDA01
END-DEFINE
*
RP1. REPEAT
*
  INPUT USING MAP 'MAP01'
*
  IF #NAME-START = '.' THEN
    ESCAPE BOTTOM (RP1.)
  END-IF
*
  IF #NAME-END = ' ' THEN
    MOVE #NAME-START TO #NAME-END
  END-IF
*
  RD1. READ EMPLOYEES-VIEW BY NAME
    STARTING FROM #NAME-START
    ENDING AT #NAME-END
*    
    IF LEAVE-DUE &gt;= 20 THEN
      PERFORM MARK-SPECIAL-EMPLOYEES
    ELSE
      RESET #MARK
    END-IF
*
    DISPLAY NAME 3X DEPT 3X LEAVE-DUE 3X '&gt;=20' #MARK

  END-READ
*
  IF *COUNTER (RD1.) = 0 THEN
    REINPUT 'No employees meet your criteria.'
  END-IF
*
END-REPEAT
*
END</pre> 
                 </li>
         <li> 
                   
                   
            <p class="instep">Run the program.</p> 
                   
                 
         </li>
         <li> 
                   
                   
            <p class="instep">Enter "JONES" as the starting name and
                       press <span class="key">ENTER</span>.
            </p> 
                   
                   
            <p class="instep">The resulting list should still show an asterisk for each employee
                       who has 20 days of leave and more.
            </p> 
                 
         </li>
         <li> 
                   
                    
                   
            <p class="instep">To return to the program editor, enter
                       <code>EDIT</code> at the <code>MORE</code> prompt.
            </p> 
                   
                 
         </li>
         <li> 
                   
                   
            <p class="instep">Stow the program.</p> 
                   
                 
         </li>
      </ol> 
           
          
      <p>You can now proceed with the next exercises:
              <a href="fs-subprog.htm#fs-subprog">Subprograms</a>.
      </p> 
         
      <div class="noprint">
         <div class="nospy">
            <p><a href="fs-extsub.htm#Top"><img src="../graphics/uparrow.png" alt="Top of page" height="17" width="17" border="0"></a></p>
            <table border="0" cellpadding="0" cellspacing="0" width="97%">
               <col width="15%">
               <col width="34%">
               <col width="48%">
               <tr>
                  <td class="footer"><img src="../graphics/blank.png" width="3" height="10">&nbsp;<a class="navig" target="_blank" href="http://www.softwareag.com">www.softwareag.com</a>&nbsp;
                  </td>
                  <td nowrap class="footer"><img src="../graphics/blank.png" width="3"><a class="navig" href="../general/legal.htm" target="_blank">Copyright &copy; Software AG 1992-2008. All rights reserved.&nbsp;</a></td>
                  <td class="bottomlinks" align="right" nowrap><img src="../graphics/blank.png" width="3"><a class="navig" target="_blank" href="../fts/search.htm" onclick="window.open('../fts/search.htm', 'fts', 'dependent,width=555,height=420,resizable'); return false">SEARCH</a>
                     &nbsp;&nbsp;<a class="navig" href="javascript:sized_window('../navig/navig.htm')" onclick="document.cookie='sagphdcc=../firststeps/fs-extsub.htm;path=/'; window.open('../navig/navig.htm', 'nvgtr', 'dependent,width=450,height=270,resizable'); return false">CONTENTS</a>&nbsp;&nbsp;&nbsp;|
                     &nbsp;&nbsp;<a class="navig" target="_blank" href="http://documentation.softwareag.com/natural/nat635unx/pdf/firststeps/fs-extsub.pdf">PDF PAGE</a>
                     &nbsp;&nbsp;<a class="navig" target="_blank" href="../general/print.htm">PDF BOOKS</a>&nbsp;&nbsp;&nbsp;|
                     &nbsp;&nbsp;<a class="navig" href="../overview.htm">HOME</a>
                     &nbsp;&nbsp;<a class="navig" href="fs-over.htm">UP</a>
                     &nbsp;&nbsp;<a class="navig" href="fs-gda.htm">PREV</a>
                     &nbsp;&nbsp;<a class="navig" href="fs-subprog.htm">NEXT</a></td>
               </tr>
            </table>
         </div>
      </div>
   </body>
</html>