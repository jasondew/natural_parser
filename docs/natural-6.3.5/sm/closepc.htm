
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   
      <meta name="generator" content="Sagdoc XSL Stylesheets">
      <link rel="stylesheet" type="text/css" href="../general/style2.css"><script language="JavaScript" src="../general/selbox.js"></script><script type="text/javascript" language="javascript">
         <!--
window.name = 'contents';
//--></script><title>CLOSE PC FILE</title>
   </head>
   <body bgcolor="#FFFFFF" background="../graphics/bar.png" style="margin-left: 20px;">
      <div><a name="closepc" id="26200"></a></div>
      <div class="noprint">
         <div class="nospytext">
            <table border="0" cellpadding="0" cellspacing="0" width="97%">
               <col width="15%">
               <col width="34%">
               <col width="48%">
               <tr>
                  <td colspan="2" class="topline"><a name="Top"></a>&nbsp;<img src="../graphics/natux_logo.png"></td>
                  <td class="topline" align="right"><img src="../graphics/sag_logo.png">&nbsp;
                  </td>
               </tr>
               <tr>
                  <td class="header" nowrap><img src="../graphics/blank.png" width="3" height="10"></td>
                  <td class="header"><img src="../graphics/blank.png" width="3">Version&nbsp;6.3.5 for UNIX
                  </td>
                  <td class="toplinks" align="right" nowrap><img src="../graphics/blank.png" width="3"><a class="navig" target="_blank" href="../fts/search.htm" onclick="window.open('../fts/search.htm', 'fts', 'dependent,width=555,height=420,resizable'); return false">SEARCH</a>
                     &nbsp;&nbsp;<a class="navig" href="javascript:sized_window('../navig/navig.htm')" onclick="document.cookie='sagphdcc=../sm/closepc.htm;path=/'; window.open('../navig/navig.htm', 'nvgtr', 'dependent,width=450,height=270,resizable'); return false">CONTENTS</a>&nbsp;&nbsp;&nbsp;|
                     &nbsp;&nbsp;<a class="navig" target="_blank" href="http://documentation.softwareag.com/natural/nat635unx/pdf/sm/closepc.pdf">PDF PAGE</a>
                     &nbsp;&nbsp;<a class="navig" target="_blank" href="../general/print.htm">PDF BOOKS</a>&nbsp;&nbsp;&nbsp;|
                     &nbsp;&nbsp;<a class="navig" href="../overview.htm">HOME</a>
                     &nbsp;&nbsp;<a class="navig" href="sm-over.htm">UP</a>
                     &nbsp;&nbsp;<a class="navig" href="closecon.htm">PREV</a>
                     &nbsp;&nbsp;<a class="navig" href="closepri.htm">NEXT</a></td>
               </tr>
            </table>
         </div>
      </div>
      <div class="nospytext" style="margin-top:0.25in;">
         <div><span class="module">&nbsp;&#8212;&nbsp;&nbsp;Statements&nbsp;&nbsp;&#8212;</span></div>
      </div> 
        
      <div class="nospytext">
         <h1> CLOSE PC FILE 
               <a name="x42"></a></h1>
      </div> 
         
          
          
      <table border="0" class="syntax" cellpadding="3"> 
               
                
              
         <tbody align="left" valign="top"> 
                  
            <tr> 
                      
               <td rowspan="2" nowrap> <a href="closepc.htm#cpcf_func">
                      <code class="keyword">CLOSE</code> </a> 
               </td> 
                      
               <td rowspan="2"> 
                  
                  <p><img src="../graphics/cbo2.gif" alt="" width="6" height="38"></p> 
               </td> 
                      
               <td align="left" nowrap> <a href="closepc.htm#cpcf_func">
                      <code class="keyword">PC</code> </a> 
               </td> 
                      
               <td rowspan="2"> 
                  
                  <p><img src="../graphics/cbc2.gif" alt="" width="6" height="38"></p> 
               </td> 
                      
               <td rowspan="2" nowrap> [<code class="keyword">FILE</code>]
                        <a href="closepc.htm#cpcf_wfn"> <var>work-file-number</var>
                             </a> 
               </td> 
                     
            </tr> 
                  
            <tr> 
                      
               <td align="left" nowrap> <a href="closepc.htm#cpcf_func">
                      <code class="keyword">WORK</code> </a> 
               </td> 
                     
            </tr> 
                 
         </tbody> 
             
      </table> 
          
         
      <p>This document covers the following topics:</p>
         
      <ul>
         <li>
            <p class="initem"><a href="closepc.htm#cpcf_func">Function</a></p>
         </li>
         <li>
            <p class="initem"><a href="closepc.htm#syntax_descr_close_pc_file">Syntax Description</a></p>
         </li>
         <li>
            <p class="initem"><a href="closepc.htm#cpcf_ex">Example</a></p>
         </li>
      </ul> 
         
      <p>For an explanation of the symbols used in the syntax diagram, see
             <a href="synsym.htm#Syntax_Symbols">Syntax
            Symbols</a>.
      </p> 
         
      <p>Related Statements: <a href="download.htm#download">DOWNLOAD PC
                FILE</a> | <a href="upload.htm#upload">UPLOAD PC FILE</a> 
      </p>
         
      <p>Belongs to Function Group: <a href="stmt.htm#Control_of_Work_Files">Control of Work Files / PC
            Files</a></p> 
        
      <hr> 
        
      <div><a name="cpcf_func"></a></div> 
         
      <h2> Function </h2> 
          
          
      <p>The statement <code>CLOSE PC FILE</code> is used to close a specific PC
              work file. It allows you to explicitly specify in a program that a PC work file
              is to be closed.
      </p> 
          
      <p>A work file is also closed automatically when command mode is
              reached.
      </p> 
           
          
      <p>See also the <a href="../ntc/ntc-over.htm">Natural
                 Connection</a> and Entire Connection documentation.
      </p> 
          
        
        
      <div class="noprint">
         <p><a href="closepc.htm#Top"><img src="../graphics/uparrow.png" alt="Top of page" height="17" width="17" border="0"></a></p>
      </div>
      <div><a name="syntax_descr_close_pc_file"></a></div> 
         
      <h2> Syntax Description </h2> 
          
           
           
      <table border="1" class="color" cellpadding="3" width="97%"> 
                
               
         <tbody align="left" valign="top"> 
                   
            <tr> 
                       
               <th align="left" nowrap> <a name="cpcf_wfn"></a>
                   <var>work-file-number</var>  
               </th> 
                       
               <td align="left"> 
                  
                  <p>The <var>work-file-number</var> is the number of
                      the PC work file to be closed.
                  </p> 
                           
                  <p>This number must correspond to one of the
                               <a href="../ntc/ntc-prep.htm#ntc-prep">work file numbers</a> for
                               the PC as defined to Natural.
                  </p> 
               </td> 
                      
            </tr> 
                  
         </tbody> 
              
      </table> 
           
          
        
        
      <div class="noprint">
         <p><a href="closepc.htm#Top"><img src="../graphics/uparrow.png" alt="Top of page" height="17" width="17" border="0"></a></p>
      </div>
      <div><a name="cpcf_ex"></a></div> 
         
      <h2> Example </h2> 
          
          
      <p>The following program demonstrates the use of the <code>CLOSE PC
            FILE</code> statement.
      </p> 
          <pre class="verbatim">** Example 'PCCLEX1': CLOSE PC FILE                                     
**                                                                      
** NOTE: Example requires that Natural Connection is installed.         
************************************************************************
DEFINE DATA LOCAL                                                       
01 W-DAT   (A40)                                                        
01 REC-NUM (N3)                                                         
01 I       (P3)                                                         
END-DEFINE                                                              
*                                                                       
REPEAT                                                                  
<strong>UPLOAD PC FILE 7 ONCE W-DAT                /* Data upload</strong>   
  AT END OF FILE                                                        
    ESCAPE BOTTOM                                                       
  END-ENDFILE                                                           
  INPUT 'Processing file' W-DAT (AD=O)                                  
    /   'Enter record number to display' REC-NUM                        
  IF REC-NUM = 0                                                        
    STOP                                                                
  END-IF                                                       
  FOR I = 1 TO REC-NUM                                         
    UPLOAD PC FILE 7 ONCE W-DAT                                
    AT END OF FILE                                             
      WRITE 'Max. record number reached, last record is'       
      ESCAPE BOTTOM                                            
    END-ENDFILE                                                
  END-FOR                                                      
  I := I - 1                                                   
  WRITE 'Record' I ':' W-DAT                                     
<strong>CLOSE PC FILE 7                            /* Close PC file 7</strong>
END-REPEAT                                                     
END                                                           </pre> 
          <h4 class="floating-title">Output of Program PCCLEX1:</h4> 
          
      <p>When you run the program, a window appears in which you specify the name
              of the PC file from which the data is to be uploaded. The data is then uploaded
              from the PC. At the end of each loop, the PC file is closed.
      </p> 
          
        
       
      <div class="noprint">
         <div class="nospy">
            <p><a href="closepc.htm#Top"><img src="../graphics/uparrow.png" alt="Top of page" height="17" width="17" border="0"></a></p>
            <table border="0" cellpadding="0" cellspacing="0" width="97%">
               <col width="15%">
               <col width="34%">
               <col width="48%">
               <tr>
                  <td class="footer"><img src="../graphics/blank.png" width="3" height="10">&nbsp;<a class="navig" target="_blank" href="http://www.softwareag.com">www.softwareag.com</a>&nbsp;
                  </td>
                  <td nowrap class="footer"><img src="../graphics/blank.png" width="3"><a class="navig" href="../general/legal.htm" target="_blank">Copyright &copy; Software AG 1992-2008. All rights reserved.&nbsp;</a></td>
                  <td class="bottomlinks" align="right" nowrap><img src="../graphics/blank.png" width="3"><a class="navig" target="_blank" href="../fts/search.htm" onclick="window.open('../fts/search.htm', 'fts', 'dependent,width=555,height=420,resizable'); return false">SEARCH</a>
                     &nbsp;&nbsp;<a class="navig" href="javascript:sized_window('../navig/navig.htm')" onclick="document.cookie='sagphdcc=../sm/closepc.htm;path=/'; window.open('../navig/navig.htm', 'nvgtr', 'dependent,width=450,height=270,resizable'); return false">CONTENTS</a>&nbsp;&nbsp;&nbsp;|
                     &nbsp;&nbsp;<a class="navig" target="_blank" href="http://documentation.softwareag.com/natural/nat635unx/pdf/sm/closepc.pdf">PDF PAGE</a>
                     &nbsp;&nbsp;<a class="navig" target="_blank" href="../general/print.htm">PDF BOOKS</a>&nbsp;&nbsp;&nbsp;|
                     &nbsp;&nbsp;<a class="navig" href="../overview.htm">HOME</a>
                     &nbsp;&nbsp;<a class="navig" href="sm-over.htm">UP</a>
                     &nbsp;&nbsp;<a class="navig" href="closecon.htm">PREV</a>
                     &nbsp;&nbsp;<a class="navig" href="closepri.htm">NEXT</a></td>
               </tr>
            </table>
         </div>
      </div>
   </body>
</html>